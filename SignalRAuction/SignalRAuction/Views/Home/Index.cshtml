@{
    ViewBag.Title = "Index";
}

<meta http-equiv="X-UA-Compatible" content="IE=edge" />
@*<link href="~/Content/Css/Reset.css" rel="stylesheet" />*@
<link href="~/Content/Css/Style.css" rel="stylesheet" />
<link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:700' rel='stylesheet' type='text/css'>
<script src="~/Scripts/jquery-1.6.4.min.js"></script>

<script type="text/javascript" src="~/Scripts/jquery.signalR-1.0.0-rc2.min.js"></script>

<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>


<script type="text/javascript">
    $(function () {
        // Get the proxy
        var auctionHub = $.connection.auctionHub;


        // Declare a function on the chat hub so the server can invoke it
        auctionHub.client.auctionRefresh = function (model) {

            $('#total-bids span').text(model.BidsTotal);
            $('#value-time').text(model.TimeRemaining);
            
            decrementTimeRemaining();
        };

        $("#prod-btn-bid").click(function () {
            auctionHub.server.placeBid($('#prod-value-bid').val());
        });


        // Start connection
        $.connection.hub.start().done(function () {
            auctionHub.server.callRefresh();
        });

    });

    function decrementTimeRemaining() {
        var amount = 0,//parseInt($('#amount').val()),
            counter = parseInt($('#value-time').text());

        var interval = setInterval(function () {
            $('#value-time').text(counter--);
            if (amount > parseInt($('#value-time').text())) {
                clearInterval(interval);
            }
        }, 1000);
    }


    function getTypeTime() {
        if (t > 86400) {
            return Math.floor(t / 86400) + ' days ago';
        } else if (t > 3600) {
            return Math.floor(t / 3600) + ' hours ago';
        } else if (t > 60) {
            return Math.floor(t / 60) + ' minutes ago';
        } else {
            return t + ' seconds ago';
        }
    }
</script>


<div id="wrapper">
    <h2 id="title-bid">Buy an Astronaut Clothes</h2>
    <div id="auction-wrapper">
        <div id="picture">
            <img src="~/Content/Images/Apollo_17_On_Moon.jpg" />
        </div>
        <div id="auction">
            <div id="time">
                <span id="title-time">Remaining</span>
                <span id="value-time">30</span>
                <span id="type-time">secs</span>
            </div>
            <div id="bid-send">
                <h3 id="title-bid-now">Do a bid now:</h3>
                <span id="currency">$</span>
                <input type="text" id="prod-value-bid" maxlength="5" />
                <input type="button" id="prod-btn-bid" value="Place Bid" />
            </div>
        </div>
    </div>
    <h2 id="total-bids">Already was done <span>76</span> bids</h2>
</div>
